/* =========================
   Tiptap â€“ Global & Table (SCSS)
   ========================= */

$slate-50:  #f8fafc;
$slate-100: #f1f5f9;
$slate-200: #e2e8f0;
$slate-500: #64748b;
$violet-600:#7c3aed;

.tiptap {
  /* Hilangkan margin top node pertama */
  :first-child { margin-top: 0; }

  /* Table */
  table {
    border-collapse: collapse;
    margin: 0;
    overflow: hidden;
    table-layout: fixed;
    width: 100%;
    background: #fff;

    td,
    th {
      border: 1px solid $slate-200;
      box-sizing: border-box;
      min-width: 1em;
      padding: 6px 8px;
      position: relative; /* overlay & handle */
      vertical-align: top;
      word-wrap: break-word;

      > * { margin-bottom: 0; }
    }

    th {
      background-color: $slate-50;
      font-weight: 600;
      text-align: left;
    }

    /* Selected cell overlay */
    .selectedCell {
      &::after {
        content: "";
        position: absolute;
        inset: 0;
        background: rgba(229, 231, 235, 0.5); /* gray-200 w/ alpha */
        pointer-events: none;
        z-index: 2;
      }
    }

    /* Column resize handle (ProseMirror) */
    .column-resize-handle {
      position: absolute;
      right: -2px;
      top: 0;
      bottom: -2px;
      width: 4px;
      background-color: $violet-600;
      pointer-events: none;
    }
  }

  /* Wrapper scroll untuk tabel lebar */
  .tableWrapper {
    margin: 1.5rem 0;
    overflow-x: auto;
  }

  /* Cursor saat resize kolom */
  &.resize-cursor { cursor: col-resize; }

  /* =========================
     Drag-to-Upload Highlight
     ========================= */
  &-surface.is-dragover {
    outline: 2px dashed $slate-500;
    outline-offset: 4px;
    background-color: $slate-100;
  }

  /* =========================
     Image Defaults
     ========================= */
  img {
    display: block;
    height: auto;
    max-width: 100%;
    margin: 0; /* margin dipindah ke wrapper ri-wrap */

    &.ProseMirror-selectednode {
      outline: 3px solid $violet-600;
    }
  }
}

/* ======================================
   Resizable Image NodeView (ri-*)
   ====================================== */

.ri-wrap {
  position: relative;
  display: inline-block;
  max-width: 100%;
  margin: 1rem 0; /* margin di wrapper, bukan <img> */
  line-height: 0;

  /* Pastikan prose/tiptap tak menambah margin ke img */
  .prose & img,
  .tiptap & img {
    margin: 0 !important;
    width: 100%;
    display: block;
  }

  &.is-selected img { outline: 2px solid $violet-600; }
  &.is-resizing img { cursor: move; }

  /* Handle bulat */
  .ri-h {
    position: absolute;
    width: 10px;
    height: 10px;
    background: #fff;
    border: 2px solid $slate-500;
    border-radius: 9999px;
    box-shadow: 0 1px 2px rgba(15, 23, 42, 0.15);
    z-index: 10;
    user-select: none;

    &-nw { left: -6px; top: -6px; cursor: nw-resize; }
    &-n  { left: 50%; top: -6px; transform: translateX(-50%); cursor: n-resize; }
    &-ne { right: -6px; top: -6px; cursor: ne-resize; }
    &-e  { right: -6px; top: 50%; transform: translateY(-50%); cursor: e-resize; }
    &-se { right: -6px; bottom: -6px; cursor: se-resize; }
    &-s  { left: 50%; bottom: -6px; transform: translateX(-50%); cursor: s-resize; }
    &-sw { left: -6px; bottom: -6px; cursor: sw-resize; }
    &-w  { left: -6px; top: 50%; transform: translateY(-50%); cursor: w-resize; }
  }
}
